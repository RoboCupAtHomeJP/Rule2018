# Storing Groceries

店で買ってきた食料品などがテーブルに置かれている。
これらを戸棚に片付けることが、このテストの目的である。
ただし、戸棚にはすでにいくつかの品物が分類されて置かれており、
新たな品物もそれに従って配置されなければならない(例えば、リンゴがある場所に買ってきたリンゴを置く、など)。

## Focus

1. 物体の検出と認識・分類
1. 物体のマニピュレーション

## Task
1. 設定
   * **場所:** アリーナ内の書棚、あるいは食器棚を一つ使用する。その近くにはテーブルが置かれているか、または近くに配置することができる。

   * **開始位置:** 戸棚とテーブルの間のランダムな位置で、戸棚と向かいあった状態で開始するものとする。

   * **戸棚:** 戸棚には床から0.30m〜1.80mの高さの間に5つの棚板があり、各物体が配置されているものとする。戸棚にはドアが一枚あり、開始時は閉じた状態とする。このドアは、画像内の網掛けの領域で示すように戸棚の半分（例えば、左または下半分）を覆い、いくつかの物体全体を覆った状態とする。

   * **テーブル:** 戸棚近くのテーブルには10個の物体が配置してある。テーブルに配置されている物体が不足している場合は、競技中に追加する。また、テーブルと戸棚の距離は最大2mとする。

   * **物体:** 戸棚およびテーブル上の物体は、既知のもの(known)、類似のもの(alike)、未知のもの(unknown)からなる。また、それぞれの棚には複数の物体があるものとする。

1. 課題
   * **ドアを開ける:** 戸棚のドアを開ける。ドアを開けることができない場合は、審判に代わりにドアを開けてもらうよう求めてもよい。
   * **戸棚の認識:** 戸棚を調査し、配置してある食料品を探して分類する。
   * **テーブルを見つける:** 振り返ってテーブルの位置を特定する。
   * **テーブルの認識:** テーブルに近づき、新しく購入した食料品（物体）の分析を開始する。
   * **物体の移動:** 最初にテーブルから戸棚へ移動させる物体を選択し、同様の物体をすべて一緒の場所に配置する。
     * 同じタイプの物体（同一の既知(known)または同種の類似(alike)の物体）は隣り合うように配置しなければならない。
     * 戸棚に同じタイプの物体がない場合は、物体をカテゴリ別（例えば、飲み物と飲み物、スナックとスナック、など）にグループ化しなければならない。
     * 戸棚に類似の物体がない場合は、ロボットはこの問題の解決方法を明確に宣言しなければならない。例えば、新たに発見したカテゴリのための保管場所を定義する（例えば、食品が見つかったが、戸棚に対応する食品がない場合）、または新しい物体をすべて同一のグループにする（例えば、未知の物体をすべてまとめて配置する場合）ことが可能。

   * **注意:** 検出した物体の名前は、ロボットが物体を掴む前後どちらで発表してもよい。 
   * **繰り返し:** 制限時間に達するか、または5つの食料品を保管するまでこれを繰り返す。

![戸棚](https://github.com/RoboCupAtHomeJP/Rule2018/blob/images/storing_groceries.png "戸棚")

## Additional Rules and Remarks
* **物体操作の回避:** この試験中のCONTINUEルールによる物体操作の回避は禁止とする。
* **セットアップなし:** セットアップ時間は設けない。
* **開始:** ロボットは、簡単な音声コマンドまたはスタートボタンで起動するものとする。
* **シングルトライ:** ロボットは初回の試行でスタートしなければならない。この試験では、再スタートは設けない。もしロボットをスタートできない場合は、ただちにロボットを退場させなければならない。
* **衝突:** 戸棚に軽く触れることは許容する（ただし非推奨）。物体を破壊したり、その他の大きな衝突を起こした場合はすぐに試験を終了する。
* **認識レポート:** ロボットは、以下を含むPDFレポートファイルを作成しなければならない。
  * チーム名
  * 試行番号（各試行を識別するため）
  * 日時
  * 初期状態の戸棚の画像。各グループを囲む境界ボックスと、それらを識別するための、人が判読可能なラベルが表示されているもの。
  * 移動した物体のリスト。各物体には、境界ボックス内に対象の物体が表示された画像を添付し、その画像には物体の名前、カテゴリ、および物体を分類するために使用される他の関連情報を示すラベルが表示されているものとする。
  * 最終的な状態の戸棚の画像。各グループを囲む境界ボックスと、それらを識別するための、人が判読可能なラベルが表示されているもの。

レポートファイルは、ロボットからUSBスティックに出力すること。このUSBスティックは、試験の直後にTCが収集する。PDFファイルの名前は次の形式とする。
TeamName_RunNumber.pdf

* **備考:** どのラベルがどの物体に属しているか明確に示すこと。レポートは人（TC）が採点するため、物体を容易に認識できるような表示とすること。

* **備考:** レポートに記載された判定結果に誤りがある（物体ではないもの、例えば、棚の端などに対してラベルを付けている）場合はペナルティーを科す。

* **未知の物体:** 多くの物体は未知のものである。これらのラベル付けは以下をもって正しいとする。 
  * 未知の物体に既知または類似の物体のラベルを適用せず、単に「不明」とラベル付けする。
  * 未知の物体のうち同じカテゴリに属する組に同じラベルを付ける。（これは、例えば、ある組については「タイプ_X」、別の組については「関連する特徴_Y」といったラベル付けでよい）。
  * 未知の物体に対して、適当な新しいラベルを付ける。

* **明確な領域:** ロボットは、戸棚とテーブルの距離が近いことは明白だと想定してよく、課題のためにわずかに後方に移動することができる。

## OC Instructions

* 競技の2時間前にロボットの始動場所を申し出ること。

* 物体を戸棚に配置し、またそれと同じクラスの物体をいくつかテーブルの上に配置すること。スペースがあるときやロボットが他の物体を要求した場合、新しいアイテムを配置することができる。
* 戸棚のドアを閉じること。 
* テーブル上に物体を配置し、戸棚へはそれに対応する物体を配置すること。テーブル、戸棚とも、既知の物体は3つ、類似物体は2つ、未知の物体は5つとする。

## Score Sheet

この競技の時間は最大で1 + 2 + 2分とする。
最初の1分は、ロボットが自力で戸棚のドアを開けるための時間とする。
その時間内にロボットがドアを開けることができない場合は、審判がドアを開ける。
ロボットが1分以内にドアを開けることができた場合は、ロボットは時間的にわずかに有利になる。
その後の2分間は、ロボットが物体を認識し、操作する時間とする。
この時間内に一つ以上の物体を操作した場合、試験時間を2分間追加する。そうでない場合、テストを終了する。

|Action　　　　　　　　　　　　　　　|Score　　　|
|:-|-:|
|||
|***Test Phase:***||
|　**ドアを開ける**			||
| 人の助けを受けずにドアを開ける |20|
|　**物体のマニピュレーション**			||
|　物体を把持する（5cm移動し、かつ10秒以上保持すること）|5x10|
|　物体を同じクラスの物体の近くに配置する		|5x10|
|　物体をその他の場所に配置する		|5x5|
|　**既知物体または類似物体の認識**			||
|　既知・類似の物体について、レポートファイル上で正しく認識されている		|10x5|
|　**未知物体または類似物体の認識**			||
|　未知物体を"unknown"と正しくラベル付けする		|10x5|
|　未知物体の*組*に同一のラベルを付ける（例：二つのパパイヤに"class A"とラベルを付ける）		|5x20|
|　**誤認識**			||
|ラベルの誤り|10x-5|
|||
|***Special penalties & bonuses:***	||
|　Not attending					|-50|
|　Outstanding performance		|15|
|||
|合計(penaltiesとbonusesを除いて)   |320|
